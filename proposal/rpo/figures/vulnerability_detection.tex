\begin{figure}
    \centering

    \begin{subfigure}[t]{1\linewidth}
        \begin{lstlisting}
        http://victim.com/page.asp
        http://victim.com/page.asp@@/@@**PAYLOAD**@@//@@
        http://victim.com/page.asp@@/@@**PAYLOAD**@@/@@style.css
        \end{lstlisting}
        \caption{Path Parameter (Simple)}
        \label{rpo:fig:taint:parameter_simple}
    \end{subfigure}

    \begin{subfigure}[t]{1\linewidth}
        \begin{lstlisting}
        http://victim.com/page.php/param1/param2
        http://victim.com/page.php/**PAYLOAD**param1/**PAYLOAD**param2@@//@@
        http://victim.com/page.php/**PAYLOAD**param1/**PAYLOAD**param2@@/@@style.css
        \end{lstlisting}
        \caption{Path Parameter (PHP or ASP)}
        \label{rpo:fig:taint:parameter_php}
    \end{subfigure}

    \begin{subfigure}[t]{1\linewidth}
        \begin{lstlisting}
        http://victim.com/page.jsp;param1;param2
        http://victim.com/page.jsp;**PAYLOAD**param1;**PAYLOAD**param2@@//@@
        http://victim.com/page.jsp;**PAYLOAD**param1;**PAYLOAD**param2@@/@@style.css
        \end{lstlisting}
        \caption{Path Parameter (JSP)}
        \label{rpo:fig:taint:parameter_jsp}
    \end{subfigure}

    \begin{subfigure}[t]{1\linewidth}
        \begin{lstlisting}
        http://victim.com/dir/page.aspx
        http://victim.com/**PAYLOAD**@@/..%2F@@dir/**PAYLOAD**@@/..%2F@@page.aspx@@//@@
        http://victim.com/**PAYLOAD**@@/..%2F@@dir/**PAYLOAD**@@/..%2F@@page.aspx@@/@@style.css
        \end{lstlisting}
        \caption{Encoded Path}
        \label{rpo:fig:taint:path}
    \end{subfigure}

    \begin{subfigure}[t]{1\linewidth}
        \begin{lstlisting}
        http://victim.com/page.html?k1=v1&k2=v2
        http://victim.com/page.html@@%3F@@k1=**PAYLOAD**v1&k2=**PAYLOAD**v2@@//@@
        http://victim.com/page.html@@%3F@@k1=**PAYLOAD**v1&k2=**PAYLOAD**v2@@/@@style.css
        \end{lstlisting}
        \caption{Encoded Query}
        \label{rpo:fig:taint:query}
    \end{subfigure}

    \begin{subfigure}[t]{1\linewidth}
        \begin{lstlisting}
        http://victim.com/page.php?key=value
        http://victim.com/page.php@@//@@?key=value
        http://victim.com/page.php@@/@@style.css

        Original Cookie: k1=v1; k2=v2
         Crafted Cookie: k1=**PAYLOAD**v1; k2=**PAYLOAD**v2
        \end{lstlisting}
        \caption{Cookie}
        \label{rpo:fig:taint:cookie}
    \end{subfigure}

    \caption{Various techniques of \redbold{path confusion} and \bluebold{style
    injection}. In each example, the first URL corresponds to the regular page, and
    the second one to the page URL crafted by the attacker. Each HTML page is
    assumed to reference a stylesheet at \protect\texttt{../style.css}, resulting in the
    browser expanding the stylesheet path as shown in the third URL.
    \bluebold{PAYLOAD} corresponds to
    \bluebold{\texttt{\%0A\{\}body\{background:NONCE\}}} (simplified), where
    \texttt{NONCE} is a randomly generated string.}

    \label{rpo:fig:taint_techniques}
\end{figure}
